"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.cognitoConfirmSignup = cognitoConfirmSignup;
const client_cognito_identity_provider_1 = require("@aws-sdk/client-cognito-identity-provider");
const helpers_1 = require("./helpers");
async function cognitoConfirmSignup(user, code, config) {
    const cognito = new client_cognito_identity_provider_1.CognitoIdentityProviderClient({
        region: config.awsRegion,
    });
    const validateEmailCommand = new client_cognito_identity_provider_1.ConfirmSignUpCommand({
        ClientId: config.userPoolClientId,
        Username: user,
        ConfirmationCode: code,
    });
    const { Session } = await cognito.send(validateEmailCommand);
    const initiateAuthCommand = new client_cognito_identity_provider_1.InitiateAuthCommand({
        AuthFlow: client_cognito_identity_provider_1.AuthFlowType.USER_AUTH,
        ClientId: config.userPoolClientId,
        Session,
    });
    const initAuthResponse = await cognito.send(initiateAuthCommand);
    return (0, helpers_1.getAuthDataFromAuthInitResponse)(initAuthResponse);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29nbml0by1jb25maXJtLXNpZ24tdXAuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvYWN0aW9ucy9jb2duaXRvLWNvbmZpcm0tc2lnbi11cC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQVNBLG9EQXlCQztBQWxDRCxnR0FLbUQ7QUFDbkQsdUNBQTREO0FBR3JELEtBQUssVUFBVSxvQkFBb0IsQ0FDeEMsSUFBWSxFQUNaLElBQVksRUFDWixNQUFjO0lBRWQsTUFBTSxPQUFPLEdBQUcsSUFBSSxnRUFBNkIsQ0FBQztRQUNoRCxNQUFNLEVBQUUsTUFBTSxDQUFDLFNBQVM7S0FDekIsQ0FBQyxDQUFDO0lBRUgsTUFBTSxvQkFBb0IsR0FBRyxJQUFJLHVEQUFvQixDQUFDO1FBQ3BELFFBQVEsRUFBRSxNQUFNLENBQUMsZ0JBQWdCO1FBQ2pDLFFBQVEsRUFBRSxJQUFJO1FBQ2QsZ0JBQWdCLEVBQUUsSUFBSTtLQUN2QixDQUFDLENBQUM7SUFFSCxNQUFNLEVBQUUsT0FBTyxFQUFFLEdBQUcsTUFBTSxPQUFPLENBQUMsSUFBSSxDQUFDLG9CQUFvQixDQUFDLENBQUM7SUFFN0QsTUFBTSxtQkFBbUIsR0FBRyxJQUFJLHNEQUFtQixDQUFDO1FBQ2xELFFBQVEsRUFBRSwrQ0FBWSxDQUFDLFNBQVM7UUFDaEMsUUFBUSxFQUFFLE1BQU0sQ0FBQyxnQkFBZ0I7UUFDakMsT0FBTztLQUNSLENBQUMsQ0FBQztJQUVILE1BQU0sZ0JBQWdCLEdBQUcsTUFBTSxPQUFPLENBQUMsSUFBSSxDQUFDLG1CQUFtQixDQUFDLENBQUM7SUFDakUsT0FBTyxJQUFBLHlDQUErQixFQUFDLGdCQUFnQixDQUFDLENBQUM7QUFDM0QsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIENvZ25pdG9JZGVudGl0eVByb3ZpZGVyQ2xpZW50LFxuICBDb25maXJtU2lnblVwQ29tbWFuZCxcbiAgSW5pdGlhdGVBdXRoQ29tbWFuZCxcbiAgQXV0aEZsb3dUeXBlLFxufSBmcm9tIFwiQGF3cy1zZGsvY2xpZW50LWNvZ25pdG8taWRlbnRpdHktcHJvdmlkZXJcIjtcbmltcG9ydCB7IGdldEF1dGhEYXRhRnJvbUF1dGhJbml0UmVzcG9uc2UgfSBmcm9tIFwiLi9oZWxwZXJzXCI7XG5pbXBvcnQgeyBBdXRoRGF0YSwgQ29uZmlnIH0gZnJvbSBcIi4uL3R5cGVzXCI7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjb2duaXRvQ29uZmlybVNpZ251cChcbiAgdXNlcjogc3RyaW5nLFxuICBjb2RlOiBzdHJpbmcsXG4gIGNvbmZpZzogQ29uZmlnLFxuKTogUHJvbWlzZTxBdXRoRGF0YT4ge1xuICBjb25zdCBjb2duaXRvID0gbmV3IENvZ25pdG9JZGVudGl0eVByb3ZpZGVyQ2xpZW50KHtcbiAgICByZWdpb246IGNvbmZpZy5hd3NSZWdpb24sXG4gIH0pO1xuXG4gIGNvbnN0IHZhbGlkYXRlRW1haWxDb21tYW5kID0gbmV3IENvbmZpcm1TaWduVXBDb21tYW5kKHtcbiAgICBDbGllbnRJZDogY29uZmlnLnVzZXJQb29sQ2xpZW50SWQsXG4gICAgVXNlcm5hbWU6IHVzZXIsXG4gICAgQ29uZmlybWF0aW9uQ29kZTogY29kZSxcbiAgfSk7XG5cbiAgY29uc3QgeyBTZXNzaW9uIH0gPSBhd2FpdCBjb2duaXRvLnNlbmQodmFsaWRhdGVFbWFpbENvbW1hbmQpO1xuXG4gIGNvbnN0IGluaXRpYXRlQXV0aENvbW1hbmQgPSBuZXcgSW5pdGlhdGVBdXRoQ29tbWFuZCh7XG4gICAgQXV0aEZsb3c6IEF1dGhGbG93VHlwZS5VU0VSX0FVVEgsXG4gICAgQ2xpZW50SWQ6IGNvbmZpZy51c2VyUG9vbENsaWVudElkLFxuICAgIFNlc3Npb24sXG4gIH0pO1xuXG4gIGNvbnN0IGluaXRBdXRoUmVzcG9uc2UgPSBhd2FpdCBjb2duaXRvLnNlbmQoaW5pdGlhdGVBdXRoQ29tbWFuZCk7XG4gIHJldHVybiBnZXRBdXRoRGF0YUZyb21BdXRoSW5pdFJlc3BvbnNlKGluaXRBdXRoUmVzcG9uc2UpO1xufVxuIl19